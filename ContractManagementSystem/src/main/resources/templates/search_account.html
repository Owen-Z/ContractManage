<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>客户信息管理</title>
    <script  th:src="@{/js/jquery.min.js}" src="/js/jquery.min.js"></script>
    <script  th:src="@{/js/jquery.slimscroll.min.js }" src="/js/jquery.slimscroll.min.js"></script>
    <script  th:src="@{/js/left-side-menu.js}" src="/js/left-side-menu.js"></script>
    <link rel="stylesheet" href="css/search_account.css">


    <link rel="stylesheet" type="text/css" th:href="@{/css/left-side-menu.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/font/iconfont.css}">
    <link rel="stylesheet" th:href="@{/css/search_account.css}">
    <link rel="stylesheet" th:href="@{/css/search_process.css}">
    <link rel="stylesheet" th:href="@{/css/add_account.css}">

    <style>
        html {
            font-family: sans-serif;
            -ms-text-size-adjust: 100%;
            -webkit-text-size-adjust: 100%;
        }
        table {
            border-collapse: collapse;
            border-spacing: 0;
        }

        td,th {
            padding: 0;
        }

        .pure-table {
            border-collapse: collapse;
            border-spacing: 0;
            empty-cells: show;
            border: 1px solid #cbcbcb;
        }

        .pure-table caption {
            color: #000;
            font: italic 85%/1 arial,sans-serif;
            padding: 1em 0;
            text-align: center;
        }

        .pure-table td,.pure-table th {
            border-left: 1px solid #cbcbcb;
            border-width: 0 0 0 1px;
            font-size: inherit;
            margin: 0;
            overflow: visible;
            padding: .5em 1em;
        }

        .pure-table thead {
            background-color: #e0e0e0;
            color: #000;
            text-align: left;
            vertical-align: bottom;
        }

        .pure-table td {
            background-color: transparent;
        }

        .pure-table-odd td {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
<div class ="top" style="width: 100%;height: 80px;background-color: #397bc5">
    <span class="tt">合同管理系统</span>
    <span class="tt2">客户信息管理</span>
    <span class="user_name">用户名</span>
    <input class="back" type="button" value="退出" style="width: 50px; height: 50px; border-radius: 50%;border: none">
</div>

<div class="left-side-menu" style="top:80px ;position: fixed">
    <div class="lsm-expand-btn">
        <div class="lsm-mini-btn">
            <label>
                <input type="checkbox" checked="checked">
                <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="50" cy="50" r="30" />
                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55" />
                    <path class="line--2" d="M0 50h80" />
                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45" />
                </svg>
            </label>
        </div>
    </div>
    <div class="lsm-container">
        <div class="lsm-scroll" >
            <div class="lsm-sidebar">
                <ul>
                    <li class="lsm-sidebar-item">
                        <a href="javascript:;"><i class="my-icon lsm-sidebar-icon icon_2"></i><span>主页面</span><i class="my-icon lsm-sidebar-more"></i></a>
                        <ul>
                            <li><a th:href="@{/index}"><span>首页</span></a></li>
                            <li><a th:href="@{/login}"><span>退出</span></a></li>
                        </ul>
                    </li>
                    <li class="lsm-sidebar-item">
                        <a href="javascript:;"><i class="my-icon lsm-sidebar-icon icon_3"></i><span>合同管理</span><i class="my-icon lsm-sidebar-more"></i></a>
                        <ul>
                            <li><a th:href="@{/draft}"><span>起草合同</span></a></li>
                            <li><a th:href="@{/sign}"><span>会签合同</span></a></li>
                            <li><a th:href="@{/finalize}"><span>定稿合同</span></a></li>
                            <li><a th:href="@{/approve}"><span>审批合同</span></a></li>
                            <li><a th:href="@{/finish}"><span>签订合同</span></a></li>
                        </ul>
                    </li>
                    <li class="lsm-sidebar-item">
                        <a href="javascript:;"><i class="my-icon lsm-sidebar-icon icon_3"></i><span>查询统计</span><i class="my-icon lsm-sidebar-more"></i></a>
                        <ul>
                            <li><a th:href="@{/search_contract}"><span>合同信息查询</span></a></li>
                        </ul>
                    </li>
                    <li class="lsm-sidebar-item">
                        <a href="javascript:;"><i class="my-icon lsm-sidebar-icon icon_3"></i><span>基础数据管理</span><i class="my-icon lsm-sidebar-more"></i></a>
                        <ul>
                            <li><a th:href="@{/addCustomer}"><span>新增客户</span></a></li>
                            <li><a th:href="@{/sear_account}"><span>查询客户</span></a></li>
                        </ul>
                    </li>
                    <li class="lsm-sidebar-item">
                        <a href="javascript:;"><i class="my-icon lsm-sidebar-icon icon_1"></i><span>系统管理</span><i class="my-icon lsm-sidebar-more"></i></a>
                        <ul>
                            <li><a th:href="@{/authorize/getAll}"><span>分配合同</span></a></li>
                            <li><a th:href="@{/addUser}"><span>增加用户</span></a></li>
                            <li><a th:href="@{/search}"><span>用户管理</span></a></li>
                            <li><a th:href="@{/addRole}"><span>角色管理</span></a></li>
                            <li><a th:href="@{/search_log}"><span>日志管理</span></a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </div>

</div>
<div class="right-main">
    <div class="search-box">
        <input class="search-txt" type="text" placeholder="请输入查询信息">
        <a type="button" class="search-btn">
            <svg class="icon" viewBox="0 0 1024 1024" width="30px"><path d="M424.024 766.098c-91.619 0-177.754-35.679-242.538-100.464-133.735-133.737-133.735-351.344 0-485.078 64.784-64.784 150.919-100.462 242.538-100.462s177.754 35.677 242.539 100.462c133.733 133.735 133.735 351.34 0 485.078-64.785 64.783-150.922 100.464-242.539 100.464zM424.024 196.085c-60.637 0-117.643 23.613-160.523 66.489-88.512 88.51-88.51 232.53 0 321.040 42.876 42.876 99.885 66.491 160.523 66.491s117.643-23.614 160.523-66.491c88.51-88.51 88.51-232.53 0-321.040-42.876-42.876-99.885-66.489-160.523-66.489z" fill="#e94118" p-id="1176"></path><path d="M886.838 943.904c-14.842 0-29.684-5.663-41.010-16.986l-261.286-261.285c-22.647-22.649-22.647-59.369 0-82.018 22.647-22.647 59.37-22.647 82.018 0l261.286 261.286c22.647 22.649 22.647 59.369 0 82.018-11.325 11.322-26.167 16.985-41.010 16.985z" fill="#e94118" p-id="1177"></path></svg>
        </a>
        <!--    <button class = "bb">点击按钮</button>-->
    </div>

        <table class="pure-table">
            <thead class="text-center" style="background-color: #20C997;color: white;">
        <tr>
            <th align="center">客户编号</th>
            <th align="center">客户名称</th>
            <th align="center">客户电话</th>
            <th width="25%" align="center">客户地址</th>
            <th width="15%" align="center">客户传真</th>
            <th align="center">客户邮箱</th>
            <th width="25%" align="center">银行名称</th>
            <th align="center">客户账号</th>
            <th width="20%" align="center">备注</th>
            <th align="center">删除</th>
            <th align="center">修改</th>
        </tr>
        </thead>

            <tbody id="idData">
            </tbody>
        </table>
    <div class="page" align="center" >
        <div id="barcon" name="barcon" style="color: black ;font-size: large;font-weight: bold;"></div>
    </div>
</div>
</body>
<script>
    var back = document.getElementsByClassName("back")[0]
    back.onclick= function (){
        window.location.href = "b.html";
    }
    datas = [];
    initTable();

    //初始化数据
    function initTable()
    {
        //发送请求，后端查询数据库信息
        $.ajax({
            url: "/search_accountInit",
            type: "post",
            dataType: "json",
            data: {
            },
            success: function (data) {
                // alert(data);
                console.log(data)
                for( i = 0;i < data.length;i++)
                {
                    datas[i] = {
                        num:data[i]["num"],
                        name: data[i]["name"],
                        address: data[i]["address"],
                        tel: data[i]["tel"],
                        fax: data[i]["fax"],
                        code: data[i]["code"],
                        bank: data[i]["bank"],
                        account: data[i]["account"],
                        del: data[i]["del"]
                    }
                }
                // 2,往tbody里面创建行，有几个人（通过数组的长度）我们就创建几行,建表时自增number
                var tbody=document.querySelector("tbody");
                for(var i=0;i<datas.length;i++)  //外面的for循环 是 行tr
                {
                    var dataName;
                    var tr=document.createElement("tr");
                    tbody.appendChild(tr);
                    var td1 = document.createElement("td");
                    tr.appendChild(td1);
                    datas[i].num = i + 1;
                    td1.innerHTML=datas[i].num;
                    td1.className="num";
                    var td2 = document.createElement("td");
                    tr.appendChild(td2);
                    td2.textContent=datas[i].name;
                    td2.className="name"
                    var td3 = document.createElement("td");
                    tr.appendChild(td3);
                    td3.innerHTML=datas[i].address;
                    td3.className="address";
                    var td4 = document.createElement("td");
                    tr.appendChild(td4);
                    td4.textContent=datas[i].tel;
                    td4.className="tel"
                    var td5 = document.createElement("td");
                    tr.appendChild(td5);
                    td5.textContent=datas[i].fax;
                    td5.className="fax"
                    var td6 = document.createElement("td");
                    tr.appendChild(td6);
                    td6.textContent=datas[i].code;
                    td6.className="code"
                    var td7 = document.createElement("td");
                    tr.appendChild(td7);
                    td7.textContent=datas[i].bank;
                    td7.className="bank"
                    var td8 = document.createElement("td");
                    tr.appendChild(td8);
                    td8.textContent=datas[i].account;
                    td8.className="account"
                    var td9 = document.createElement("td");
                    tr.appendChild(td9);
                    td9.textContent=datas[i].del;
                    td9.className="del"
                }
            },
            error: function () {
                alert("请求发送失败!");
            }
        })
    }
    //分页
    function goPage(pno,psize){
        var itable = document.getElementById("idData");
        var num = itable.rows.length;//表格所有行数(所有记录数)
        //console.log(num);
        var totalPage = 0;//总页数
        var pageSize = psize;//每页显示行数
        //总共分几页
        if(num/pageSize > parseInt(num/pageSize)){
            totalPage=parseInt(num/pageSize)+1;
        }else{
            totalPage=parseInt(num/pageSize);
        }
        var currentPage = pno;//当前页数
        var startRow = (currentPage - 1) * pageSize+1;//开始显示的行  31
        var endRow = currentPage * pageSize;//结束显示的行   40
        endRow = (endRow > num)? num : endRow;    //40
        // console.log(endRow);
        //遍历显示数据实现分页
        for(var i=1;i<(num+1);i++){
            var irow = itable.rows[i-1];
            if(i>=startRow && i<=endRow){
                irow.style.display = "table-row";
                //irow.cells.style.width = "11%";
            }else{
                irow.style.display = "none";
                //irow.cells.style.width = "11%";
            }
        }
        //var pageEnd = document.getElementById("pageEnd");
        var tempStr = "共"+num+"条数据 分"+totalPage+"页 当前第"+currentPage+"页&nbsp;&nbsp;";
        if(currentPage>1){
            tempStr += "<a href=\"#\" class=\"btn btn-sm btn-primary\" onClick=\"goPage("+(1)+","+psize+")\">首页</a>&nbsp;&nbsp;";
            tempStr += "<a href=\"#\" class=\"btn btn-sm btn-primary\" onClick=\"goPage("+(currentPage-1)+","+psize+")\">上一页</a>&nbsp;&nbsp;"
        }else{
            tempStr += "<a href=\"#\" class=\"btn btn-sm btn-metal\" >首页</a>&nbsp;&nbsp;";
            tempStr += "<a href=\"#\" class=\"btn btn-sm btn-metal\" >上一页</a>&nbsp;&nbsp;";
        }

        if(currentPage<totalPage){
            tempStr += "<a href=\"#\" class=\"btn btn-sm btn-primary\" onClick=\"goPage("+(currentPage+1)+","+psize+")\">下一页</a>&nbsp;&nbsp;";
            tempStr += "<a href=\"#\" class=\"btn btn-sm btn-primary\" onClick=\"goPage("+(totalPage)+","+psize+")\">尾页</a>&nbsp;&nbsp;";
        }else{
            tempStr += "<a href=\"#\" class=\"btn btn-sm btn-metal\" >下一页</a>&nbsp;&nbsp;";
            tempStr += "<a href=\"#\" class=\"btn btn-sm btn-metal\" >尾页</a>&nbsp;&nbsp;";
        }
        tempStr +="</select>";
        document.getElementById("barcon").innerHTML = tempStr;

    }
</script>
<script type="text/javascript" language="javascript">
    window.onload = function() {  //页面加载完之后执行
        goPage(1, 10);  //1为当前页数，10为每页显示行数
    };
</script>
</html>


